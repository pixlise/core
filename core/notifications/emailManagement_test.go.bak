package notifications

import (
	"fmt"
	"strings"
)

func Example_sendEmail(){


	stack := NotificationStack{
		Notifications: nil,
		S3svc:         nil,
	}

	template := make(map[string]interface{})

	template["datasourcename"] = "test datasource"
	template["sender"] = "info@mail.pixlise.org"
	template["subject"] = "Test Dataset Available"

	err := stack.SendEmail("test-dataset-available", template, nil)
	if err != nil{
		fmt.Printf(err.Error())
	}

	// Output:
	// Email Subs found: 1
	// Email Sent to address: tom+test@spicule.co.uk
}

func Example_sendSMS(){

	stack := NotificationStack{
		Notifications: nil,
		S3svc:         nil,
	}

	template := make(map[string]interface{})

	template["datasourcename"] = "test datasource"

	err := stack.SendSms("test-dataset-available", template, nil)
	if err != nil{
		fmt.Printf(err.Error())
	}

	// Output:
	// SMS Subs found: 1
}


func Example_generateHTMLContent(){
	usermap := UserStruct{}

	templatemap := make(map[string]interface{})
	templatemap["datasourcename"] = "test datasource"
	html, err := generateHTMLEmailContent(usermap, "test-dataset-available", templatemap)
	if err != nil{
		fmt.Printf(err.Error())
	}

	if strings.Contains(html, "<head>"){
		fmt.Printf("true")
	}

	// Output:
	// true
}
